#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
Write VPRM constants into a variable a dataFrame and a text file.
"""

import pandas as pd
import numpy as np
import datetime


#
#                 VPRM Class
#Low-altitude Evergreen Needleleaf forest  1
#High-altitude Evergreen Needleleaf forest 2
#Evergreen broadleaf forest                3
#Deciduous broadleaf forest                4
#Mixed forest                              5
#Shrubland                                 6
#Savanna                                   7
#Cropland                                  8
#Grassland                                 9
#Others	                                   10

vnames = ["EF", "DF","MF","SHR","SAV","CRO","GRA","OTH"]

#lambdaGPP now includes the 0.044 eta.zero factor, so that is removed from
#processing--no longer necessary


def WriteVPRMConstants(outdir='./', nveg = 8):
    
    lambdaGPP_sw =                  np.array([0.4460574749932786,#0.38285856044272754,#EF
                                              0.2583143641241934,#0.232381454251128,#DF
                                              0.34717095317665575,#0.3180037382399692,#MF
                                              0.30020050425390693,#0.3137455808897835,#SHR
                                              0.3861712722494534,#0.3838609673492114,#SAV
                                              0.32880911225616494,#0.3040634457346484,#CRO_W
                                              0.586120531616586,#0.5515753704176884,#GRA
                                              0.00])
    
    swradZero = np.array([186.46762399208586,#211.20064087945852,#EF
                          229.01587158113654,#240.14816452944024,#DF
                          196.32063843263535,#199.7725711408126,#MF
                          106.94595506417942,#104.67256320680661,#SHR
                          245.8456385342106,#223.31380710840682,#SAV
                          194.71165018551022,#201.95226354606834,#CRO_W
                          187.36113285510206,#218.74099442234984,#GRA
                          1.00])
    
    Q = np.array([1.8255278147487266,#1.535172340491088,#EF
                  1.0499313467195532,#4.677994740230977,#DF
                  0.154467472277647,#0.7856417998431174,#MF
                  0.9853513896334563,#0.7550266294970575,#SHR
                  7.879926275569173,#7.657731358117385,#SAV
                  1.9840879090061256,#7.222542666669898,#CRO_W
                  0.2861882654534224,#0.28882716255541946,#GRA
                  0.0])
    
    theta_thres = np.array([0.39105030421844034,#0.43809710488116244,#EF
                            0.16690087323125144,#0.0548780433132861,#DF
                            0.05056895692355315,#0.16246742236539188,#MF
                            0.48984930275438526,#0.5587177366277952,#SHR
                            0.07763479878946875,#0.07635423409243683,#SAV
                            0.2478600362176573,#0.11053962748252565,#CRO_W
                            0.9997817286950028,#0.8051120650355466,#GRA
                            0.0])

    E0 = np.array([293.5874157036204,#294.1071234141203,#EF
                   111.79024925951113,#113.67378440914716,#DF
                   146.64564936636555,#102.7686821364891,#MF
                   232.62901839608202,#166.879265874549,#SHR
                   126.05026469692459,#111.06274267225466,#SAV
                   253.59531648996426,#246.5071705633374,#CRO_W
                   162.72073885636746,#91.22467170032083,#GRA
                   0.0])

    R0 = np.array([1.4423838682106556,#2.0468792135671174,#EF
                   2.095430466120644,#2.3111171670864095,#DF
                   3.0803022167955927,#3.474043889568441,#MF
                   0.765564456138067,#0.23493020649715401,#SHR
                   1.20262112632771,#1.167702613319969,#SAV
                   1.4287759163615625,#1.658876915626284,#CRO_W
                   3.0577790525239785,#0.40269878506421264,#GRA
                   0.0])

    k2 = np.array([0.3911907002973622,#0.3196660089025801,#EF
                   0.3460222115759421,#0.3309888844115725,#DF
                   0.3628469063468035,#0.34356364447445586,#MF
                   0.6791552476706728,#0.7478954174596913,#SHR
                   0.6307060621850933,#0.6317822848001649,#SAV
                   0.4587019800799496,#0.4544096108045351,#CRO_W
                   0.7318178058678403,#0.7809999972243044,#GRA
                   0.0])

    k1 = np.array([0.5772415230252927,#0.40067496056100815,#EF
                   0.2269582199196317,#0.1991182262941631,#DF
                   1.3482390267278699,#0.9007611857893716,#MF
                   0.22608151261107887,#0.3032717549456535,#SHR
                   0.4537019104886218,#0.5948974476238413,#SAV
                   1.0925525254407642,#1.443937640944124,#CRO_W
                   0.12757429835676803,#0.2724006287552362,#GRA
                   0.0])

    gamma = np.array([0.41973880837141037,#0.40979179888898204, #EF
                      0.5038297464673381,#0.49237339003778335,#DF
                      1.1767691077170381e-07,#2.8632698660925487e-09,#MF
                      0.11937654698921038,#0.21585897995645453,#SHR
                      0.44208804764955245,#0.40082593367594266,#SAV
                      0.5636721942676484,#0.3470137426846614,#CRO_W
                      0.5307421368475942,#0.6659201506065001,#GRA
                      0.0])

    tempMin = np.array([0,#EF
                        0,#DF
                        0,#MF
                        2,#SHR
                        2,#SAV
                        5,#CRO_W
                        2,#GRA
                        0])
    
    tempMax = np.array([40,#EF
                        40,#DF
                        40,#MF
                        40,#SHR
                        40,#SAV
                        40,#CRO_W
                        40,#GRA
                        40])
    
    tempOpt = np.array([20,#EF
                        20,#DF
                        20,#MF
                        20,#SHR
                        20,#SAV
                        22,#CRO_W
                        18,#GRA
                        20])
    

    outLst = pd.DataFrame()
    outLst['Class'] = vnames
    outLst['lambdaGPP.sw'] = lambdaGPP_sw
    outLst['swradZero'] = swradZero
    outLst['Q'] = Q
    outLst['theta_thres'] = theta_thres
    outLst['E0'] = E0
    outLst['R0'] = R0
    outLst['k2'] = k2
    outLst['k1'] = k1
    outLst['gamma'] = gamma
    outLst['tempMin'] = tempMin
    outLst['tempMax'] = tempMax
    outLst['tempOpt'] = tempOpt
    outLst['swradZero'] = swradZero
    
    dateLn = datetime.datetime.now()
    outfile = outdir + 'vprmConstants.' + str(dateLn.day) + str(dateLn.month) + str(dateLn.year) + '.txt'
    
    outLst.to_csv(outfile, header=True, index=None, sep=' ')

    outLst8 = outLst
    outfile = outdir + 'vprmConstants10.' + str(dateLn.day) + str(dateLn.month) + str(dateLn.year) + '.txt'
    
    outLst.to_csv(outfile, header=True, index=None, sep=' ')
    if nveg == 8:
        return outLst8
    else:
        return None

def WriteVPRMConstants_summer(outdir='./', nveg = 8):

    lambdaGPP_sw =                  np.array([0.4460574749932786,#0.38285856044272754,#EF
                                              0.2583143641241934,#0.232381454251128,#DF
                                              0.34717095317665575,#0.3180037382399692,#MF
                                              0.30020050425390693,#0.3137455808897835,#SHR
                                              0.3861712722494534,#0.3838609673492114,#SAV
                                              0.19900317298928696,#0.19729502251035178,#CRO_S
                                              0.586120531616586,#0.5515753704176884,#GRA
                                              0.00])

    swradZero = np.array([186.46762399208586,#211.20064087945852,#EF
                          229.01587158113654,#240.14816452944024,#DF
                          196.32063843263535,#199.7725711408126,#MF
                          106.94595506417942,#104.67256320680661,#SHR
                          245.8456385342106,#223.31380710840682,#SAV
                          461.6661940969337,#402.9223351590418,#CRO_S
                          187.36113285510206,#218.74099442234984,#GRA
                          1.00])

    Q = np.array([1.8255278147487266,#1.535172340491088,#EF
                  1.0499313467195532,#4.677994740230977,#DF
                  0.154467472277647,#0.7856417998431174,#MF
                  0.9853513896334563,#0.7550266294970575,#SHR
                  7.879926275569173,#7.657731358117385,#SAV
                  1.1692235924813996,#0.38635672894377343,#CRO_S
                  0.2861882654534224,#0.28882716255541946,#GRA
                  0.0])

    theta_thres = np.array([0.39105030421844034,#0.43809710488116244,#EF
                            0.16690087323125144,#0.0548780433132861,#DF
                            0.05056895692355315,#0.16246742236539188,#MF
                            0.48984930275438526,#0.5587177366277952,#SHR
                            0.07763479878946875,#0.07635423409243683,#SAV
                            0.21234976116298046,#0.2891457008117626,#CRO_S
                            0.9997817286950028,#0.8051120650355466,#GRA
                            0.0])

    E0 = np.array([293.5874157036204,#294.1071234141203,#EF
                   111.79024925951113,#113.67378440914716,#DF
                   146.64564936636555,#102.7686821364891,#MF
                   232.62901839608202,#166.879265874549,#SHR
                   126.05026469692459,#111.06274267225466,#SAV
                   120.79795004541589,#176.29972511973926,#CRO_S
                   162.72073885636746,#91.22467170032083,#GRA
                   0.0])

    R0 = np.array([1.4423838682106556,#2.0468792135671174,#EF
                   2.095430466120644,#2.3111171670864095,#DF
                   3.0803022167955927,#3.474043889568441,#MF
                   0.765564456138067,#0.23493020649715401,#SHR
                   1.20262112632771,#1.167702613319969,#SAV
                   1.7766833228663639,#1.9197142828817282,#CRO_S
                   3.0577790525239785,#0.40269878506421264,#GRA
                   0.0])

    k2 = np.array([0.3911907002973622,#0.3196660089025801,#EF
                   0.3460222115759421,#0.3309888844115725,#DF
                   0.3628469063468035,#0.34356364447445586,#MF
                   0.6791552476706728,#0.7478954174596913,#SHR
                   0.6307060621850933,#0.6317822848001649,#SAV
                   0.3490262605563874,#0.28719514978362665,#CRO_S
                   0.7318178058678403,#0.7809999972243044,#GRA
                   0.0])

    k1 = np.array([0.5772415230252927,#0.40067496056100815,#EF
                   0.2269582199196317,#0.1991182262941631,#DF
                   1.3482390267278699,#0.9007611857893716,#MF
                   0.22608151261107887,#0.3032717549456535,#SHR
                   0.4537019104886218,#0.5948974476238413,#SAV
                   3.002581954090279,#3.431598001769638,#CRO_S
                   0.12757429835676803,#0.2724006287552362,#GRA
                   0.0])

    gamma = np.array([0.41973880837141037,#0.40979179888898204, #EF
                      0.5038297464673381,#0.49237339003778335,#DF
                      1.1767691077170381e-07,#2.8632698660925487e-09,#MF
                      0.11937654698921038,#0.21585897995645453,#SHR
                      0.44208804764955245,#0.40082593367594266,#SAV
                      0.7332325819771189,#0.6297890393550836,#CRO_S
                      0.5307421368475942,#0.6659201506065001,#GRA
                      0.0])

    tempMin = np.array([0,#EF
                        0,#DF
                        0,#MF
                        2,#SHR
                        2,#SAV
                        5,#CRO_S
                        2,#GRA
                        0])

    tempMax = np.array([40,#EF
                        40,#DF
                        40,#MF
                        40,#SHR
                        40,#SAV
                        40,#CRO_S
                        40,#GRA
                        40])

    tempOpt = np.array([20,#EF
                        20,#DF
                        20,#MF
                        20,#SHR
                        20,#SAV
                        22,#CRO_S
                        18,#GRA
                        20])


    outLst = pd.DataFrame()
    outLst['Class'] = vnames
    outLst['lambdaGPP.sw'] = lambdaGPP_sw
    outLst['swradZero'] = swradZero
    outLst['Q'] = Q
    outLst['theta_thres'] = theta_thres
    outLst['E0'] = E0
    outLst['R0'] = R0
    outLst['k2'] = k2
    outLst['k1'] = k1
    outLst['gamma'] = gamma
    outLst['tempMin'] = tempMin
    outLst['tempMax'] = tempMax
    outLst['tempOpt'] = tempOpt
    outLst['swradZero'] = swradZero
    dateLn = datetime.datetime.now()
    outfile = outdir + 'vprmConstants.' + str(dateLn.day) + str(dateLn.month) + str(dateLn.year) + '.txt'

    outLst.to_csv(outfile, header=True, index=None, sep=' ')

    outLst8 = outLst
    outfile = outdir + 'vprmConstants10.' + str(dateLn.day) + str(dateLn.month) + str(dateLn.year) + '.txt'

    outLst.to_csv(outfile, header=True, index=None, sep=' ')
    if nveg == 8:
        return outLst8
    else:
        return None
